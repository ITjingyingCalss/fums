<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.fums.system_management.dao.UserManagementDao">
  <resultMap id="BaseResultMap" type="com.fums.system_management.pojo.User">
    <result column="id" jdbcType="INTEGER" property="id" />
    <result column="user_id" jdbcType="INTEGER" property="userId" />
    <result column="user_account" jdbcType="VARCHAR" property="userAccount" />
    <result column="user_name" jdbcType="VARCHAR" property="userName" />
    <result column="password" jdbcType="VARCHAR" property="password" />
    <result column="user_sex" jdbcType="VARCHAR" property="userSex" />
    <result column="user_address" jdbcType="VARCHAR" property="userAddress" />
    <result column="user_phone" jdbcType="VARCHAR" property="userPhone" />
    <result column="user_email" jdbcType="VARCHAR" property="userEmail" />
    <result column="user_salt" jdbcType="VARCHAR" property="userSalt" />
    <result column="user_state" jdbcType="INTEGER" property="userState" />
    <result column="hospital_department_child_code" jdbcType="INTEGER" property="hospitalDepartmentChildCode" />
    <result column="user_create_time" jdbcType="DATE" property="userCreateTime" />
    <result column="user_update_time" jdbcType="DATE" property="userUpdateTime" />
  </resultMap>


  <select id="selectAll" resultMap="BaseResultMap">
    select u.id, u.user_id ,u.user_account,u.user_sex,u.user_phone,
    u.user_email,u.password,h.hospital_department_name
    from
    `user` u
    LEFT JOIN user_department d ON u.id = d.id
    LEFT JOIN hospital_department h ON d.hospital_department_id = h.hospital_department_id
    where 1 = 1

    <if test="userId != null and userId != ''">
        and user_id like ('%',#{userId},'%')
    </if>
    <if test="userAccount != null and userAccount != ''">
      and user_account like ('%',#{userAccount},'%')
    </if>
    <if test="userSex != null and userSex != 0">
      and user_sex like ('%',#{userSex},'%')
    </if>
    <if test="userPhone != null and userPhone != ''">
      and user_phone like ('%',#{userPhone},'%')
    </if>
    <if test="userEmail != null and userEmail != ''">
      and user_email like ('%',#{userEmail},'%')
    </if>
    <if test="password != null and password != ''">
      and password like ('%',#{password},'%')
    </if>
    <if test="hospitalDepartmentName != null and hospitalDepartmentName !=0">
      and hospital_department_name like ('%',#{hospitalDepartmentName},'%')
    </if>
  </select>



  <select id="seleDepartment" resultMap="BaseResultMap">
    select h.hospital_department_name
    from
    `user` u
    LEFT JOIN user_department d ON u.id = d.id
    LEFT JOIN hospital_department h ON d.hospital_department_id = h.hospital_department_id
  </select>
</mapper>